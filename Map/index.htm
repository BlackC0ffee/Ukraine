<html>
<head>
    <title> Ukraine map &#127803;</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ==" crossorigin=""></script>
    <script src="config.json"></script>
    <Script src="map.js"></Script>
    <!--<script src="./plugins/leaflet-search.src.js"></script>-->
    <link rel="stylesheet" href="./style.css" />

      
<link rel="stylesheet" href="https://unpkg.com/@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.css" />
<script src="https://unpkg.com/@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.min.js"></script>  
</head>
<body>
<div id="map"></div>
<textarea id="OutputBox" rows="5" cols="50"></textarea> <button id="Save" onclick="exportData(listOfPolygons, 'test.json', 'text/plain')">Generate files</button> <a href="" id="a">click here to download your file</a> | 
<hr>
<div>
    Name: <input type="text" name="polygonName" id="polygonName">
    Color: <select id="colorList">
        <option value="#FFB400">Contested</option>
        <option value="#004BFF">Ukraine</option>  
        <option value="#C80000">Russia</option>
    </select>  
    <!--<input type="color" name="inputColor">-->
    Add: <button id="newPolygon" onclick="">New Polygon</button> | <button id="undoButton" onclick="undoButtonClick()">Undo</button>
</div>
<div>
    <select id="PolygonsList" size="3" onChange="makePolygonActive(this)";></select> <button id="removeSelected" onclick="RemoveSelected(document.getElementById('PolygonsList'))">Remove Polygon</button> | Stroke: <input type="button" value="On" id="strokeButton" onclick="onoff(this);">
</div>
<div>
    <form id="upload">
        <label for="file">File to upload</label>
        <input type="file" id="file" accept=".json">
    
        <button>Upload</button>
    </form>
</div>
<script>

//let file = document.querySelector('#file');

//Events
document.getElementById("newPolygon").addEventListener("click", newPolygonEvent);
document.getElementById("upload").addEventListener('submit', uploadJson);

//Functions
function newPolygonEvent() {
    var name;
    colorOptions = document.getElementById('colorList')
    if(document.getElementById('polygonName').value != ""){
        name = document.getElementById('polygonName').value;
    }else{
        name = colorOptions[colorOptions.selectedIndex].innerText;
    }
    newPolygon(name, colorOptions.value)
}

function onoff(e){
  currentvalue = e.value;
  if(currentvalue == "Off"){
    e.value="On";
    activePolygon.polygon.setStyle({stroke: true})
  }else{
    e.value="Off";
    activePolygon.polygon.setStyle({stroke: false})
  }
}

//MappShizzle
var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19, attribution: '© OpenStreetMap'});
var stadia = L.tileLayer('https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png', {maxZoom: 20, attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'});
var map = L.map('map', {center: [39.73, -104.99], zoom: 10, zoomDelta: 0.7, zoomSnap: 1, center: new L.latLng([config.Longitude,config.Latitude]), layers: [osm,stadia] });
//

var baseMaps = { "OpenStreetMap": osm, "Stadia Maps": stadia };
var layerControl = L.control.layers(baseMaps).addTo(map);

//var map = new L.Map('map', {zoom: config.ZoomLevel, center: new L.latLng([config.Longitude,config.Latitude]) });
var pol = new Array();
var listOfPolygons = Array();
var activePolygon

//StadiaMaps
//map.addLayer(new L.TileLayer('https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png', {
//    maxZoom: 20,
//    attribution: 
//}));

//OpenStreetmap
//L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
//    maxZoom: 19,
//    attribution: '© OpenStreetMap'
//}).addTo(map);

//https://wiki.openstreetmap.org/wiki/Tiles#Servers

//osMap (open street map with english names)
/*L.tileLayer('https://osmap.{s}.tile.mapcdn.net/en/map/v1/{z}/{x}/{y}.png', {
		maxZoom: 19,
        //minZoom: world,
		attribution: 'Data © <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors | ' + 'Licence: <a href="http://opendatacommons.org/licenses/odbl/" target="_blank" title="Open Data Commons Open Database Licence">ODbL</a> | <a href="https://www.maptilesapi.com" target="_blank" title="Tiles accessible from MapTiles API">MapTiles API</a>'
}).addTo(map);*/

map.on('click', onMapClick);

</script>
</body>
</html>
